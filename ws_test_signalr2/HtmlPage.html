<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>test33</h1>
    <input type="text" id="gname" value="" /><input type="button" value="addGroup" id="addGroup"/> <input type="button" value="remove group" id="removeGroup"/>
                                               <br />
    sendMsg <input type="text" id="sendMsg" /> <button id="sendMsgToGroup">send message to group</button>
                                               <br />
    receivemsg <span id="receiveMsgSpan"></span>
               <br />
    <script src="/Scripts/jquery-1.6.4.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="/Scripts/jquery.signalR-1.1.4.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="/signalr/hubs"></script>

    <script>
        $(function () {
            var hubProxy = $.connection.myHub;
            window.hub = hubProxy;

            let $msg = $('#msg');
            hubProxy.client.clientMethod1 = function (msg) {
                console.log(`clientMethod1: ${msg}`)
            };

            hubProxy.client.clientMethod2=function (obj) {
                console.log(obj);
            };
            hub.client.receiveMessageFromGroup = function (msg) {
                $('#receiveMsgSpan').text(msg);
            };

            let $gname = $('#gname');
            let getGName = () => $gname.val();
            let getSendMessage = () => $('#sendMsg').val();
            $.connection.hub.start().done(function () {
                //hubProxy.server.serverMethod1();
                //hubProxy.server.testAsync().done(i => console.log(i));
                console.log('done');
                $('#addGroup').bind('click', () => {
                    hub.server.addToGroup(getGName());
                });
                $('#removeGroup').bind('click', () => {
                    hub.server.removeFromGroup(getGName());
                });

                $('#sendMsgToGroup').bind('click', function (e) {
                    e.preventDefault();
                    hub.server.sendMessageToGroup(getGName(), getSendMessage());
                })




            });

        });
    </script>
</body>
</html>